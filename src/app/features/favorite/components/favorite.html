<main class="main-content">
  <div class="container">
    <div class="page-header">
      <div class="page-title-section">
        <h1>
          <div style="color: var(--color-danger);">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M16 28L13.1 25.4C5.4 18.48 0 13.56 0 7.5C0 3.42 3.42 0 7.5 0C9.74 0 11.91 0.81 13.5 2.09C15.09 0.81 17.26 0 19.5 0C23.58 0 27 3.42 27 7.5C27 13.56 21.6 18.48 13.9 25.4L16 28Z" fill="currentColor"/>
          </svg>
          </div>
          Mes Favoris
        </h1>
        <p class="subtitle">{{favoriteStore.favorites().length}} produits dans votre liste de souhaits</p>
      </div>
      <div class="page-actions">
        <button class="btn-secondary" routerLink="/">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M17 7L10 2L3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19H15C15.5304 19 16.0391 18.7893 16.4142 18.4142C16.7893 18.0391 17 17.5304 17 17V7Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M7 19V10H13V19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Continuer mes achats
        </button>
        <button class="btn-danger-outline" (click)="favoriteFacade.clearProductsInFavorites()">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.5 5H4.16667H17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M6.66667 5V3.33333C6.66667 2.89131 6.84226 2.46738 7.15482 2.15482C7.46738 1.84226 7.89131 1.66667 8.33333 1.66667H11.6667C12.1087 1.66667 12.5326 1.84226 12.8452 2.15482C13.1577 2.46738 13.3333 2.89131 13.3333 3.33333V5M15.8333 5V16.6667C15.8333 17.1087 15.6577 17.5326 15.3452 17.8452C15.0326 18.1577 14.6087 18.3333 14.1667 18.3333H5.83333C5.39131 18.3333 4.96738 18.1577 4.65482 17.8452C4.34226 17.5326 4.16667 17.1087 4.16667 16.6667V5H15.8333Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Vider la liste
        </button>
      </div>
    </div>
    <!-- Liste des produits favoris -->
    @for (product of favoriteStore.favorites(); track product.id) {
      <div class="favorites-list">
        <!-- Produit favori 1 -->
        <article class="favorite-item">
          <div class="item-image-wrapper">
            <img [ngSrc]="product.imageUrl" fill priority alt="product.name" class="item-image">
            <app-product-categories [category]="product.category"></app-product-categories>
          </div>
          <div class="item-details">
            <div class="item-header">
              <div class="item-title-section">
                <h3 class="item-name">{{product.name}}</h3>
                <p class="item-description">{{product.description}}</p>
              </div>
              <button class="btn-remove-favorite" (click)="favoriteFacade.onProductRemoveFromFavorite(product)" aria-label="Retirer des favoris">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 21L10.55 19.7C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 19.7L12 21Z"/>
                </svg>
              </button>
            </div>
            <div class="item-meta">
              <div class="item-rating">
                <div class="stars-display">
                  <span class="stars filled">★★★★★</span>
                </div>
                <span class="rating-count">({{product.rating}} avis)</span>
              </div>
              <div class="product-stock" [ngClass]="product.inStock ? 'in-stock' : 'out-stock'">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="8" cy="8" r="8" fill="currentColor"/>
                  <path d="M5 8L7 10L11 6" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>

                @if (product.inStock) {
                  <span> Disponible ({{product.quantity}} unités)</span>
                } @else {
                  <span> En rupture</span>
                }
              </div>
            </div>
            <div class="item-footer">
              <div class="item-price">
                <span class="price-current">{{product.price | currency :  'EUR'}}</span>
              </div>
              <button class="btn-add-to-cart" (click)="cartFacade.add(product, 1)">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 3L5 3L6.5 11L14 11L16 6L6.5 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <circle cx="6.5" cy="14.5" r="1" fill="currentColor"/>
                  <circle cx="12.5" cy="14.5" r="1" fill="currentColor"/>
                </svg>
                Ajouter au panier
              </button>
            </div>
          </div>
        </article>
      </div>
    }


    <!-- Actions groupées -->
    <div class="bulk-actions">
      <button class="btn-primary-large" (click)="addFavoriteProducts()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 6L10 6L13 19L25 19L28 10L11 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <circle cx="13" cy="25" r="2" fill="currentColor"/>
          <circle cx="23" cy="25" r="2" fill="currentColor"/>
        </svg>
        Ajouter tous les produits au panier
      </button>
      <p class="bulk-total">Total : <strong>{{totalPriceInFavorites() | currency : 'EUR'}}</strong></p>
    </div>

  </div>
</main>


